// 2023-04-19 15:18
#include <neon.h>
#include <neon_test.h>
// int16x8_t vshll_n_s8(int8x8_t a,const int n)
// int32x4_t vshll_n_s16(int16x4_t a,const int n)
// int64x2_t vshll_n_s32(int32x2_t a,const int n)
// uint16x8_t vshll_n_u8(uint8x8_t a,const int n)
// uint32x4_t vshll_n_u16(uint16x4_t a,const int n)
// uint64x2_t vshll_n_u32(uint32x2_t a,const int n)
// --------------------------------------------------
// int16x8_t vshll_high_n_s8(int8x16_t a,const int n)
// int32x4_t vshll_high_n_s16(int16x8_t a,const int n)
// int64x2_t vshll_high_n_s32(int32x4_t a,const int n)
// uint16x8_t vshll_high_n_u8(uint8x16_t a,const int n)
// uint32x4_t vshll_high_n_u16(uint16x8_t a,const int n)
// uint64x2_t vshll_high_n_u32(uint32x4_t a,const int n)

TEST_CASE(test_vshll_n_s8) {
    static const struct {
        int8_t a[8];
        int16_t r1[8];
        int16_t r3[8];
        int16_t r5[8];
        int16_t r6[8];
        int16_t r7[8];
    } test_vec[] = {
        {{119, -122, 124, -86, 35, -22, -78, -45},
         {238, -244, 248, -172, 70, -44, -156, -90},
         {952, -976, 992, -688, 280, -176, -624, -360},
         {3808, -3904, 3968, -2752, 1120, -704, -2496, -1440},
         {7616, -7808, 7936, -5504, 2240, -1408, -4992, -2880},
         {15232, -15616, 15872, -11008, 4480, -2816, -9984, -5760}},
        {{28, 120, 31, -47, 121, 103, 15, 63},
         {56, 240, 62, -94, 242, 206, 30, 126},
         {224, 960, 248, -376, 968, 824, 120, 504},
         {896, 3840, 992, -1504, 3872, 3296, 480, 2016},
         {1792, 7680, 1984, -3008, 7744, 6592, 960, 4032},
         {3584, 15360, 3968, -6016, 15488, 13184, 1920, 8064}},
        {{-101, -108, 56, -44, -85, -11, 89, 39},
         {-202, -216, 112, -88, -170, -22, 178, 78},
         {-808, -864, 448, -352, -680, -88, 712, 312},
         {-3232, -3456, 1792, -1408, -2720, -352, 2848, 1248},
         {-6464, -6912, 3584, -2816, -5440, -704, 5696, 2496},
         {-12928, -13824, 7168, -5632, -10880, -1408, 11392, 4992}},
        {{77, -90, -113, 79, 77, -102, -73, -59},
         {154, -180, -226, 158, 154, -204, -146, -118},
         {616, -720, -904, 632, 616, -816, -584, -472},
         {2464, -2880, -3616, 2528, 2464, -3264, -2336, -1888},
         {4928, -5760, -7232, 5056, 4928, -6528, -4672, -3776},
         {9856, -11520, -14464, 10112, 9856, -13056, -9344, -7552}},
        {{32, 51, 111, 68, 30, 34, 23, 58},
         {64, 102, 222, 136, 60, 68, 46, 116},
         {256, 408, 888, 544, 240, 272, 184, 464},
         {1024, 1632, 3552, 2176, 960, 1088, 736, 1856},
         {2048, 3264, 7104, 4352, 1920, 2176, 1472, 3712},
         {4096, 6528, 14208, 8704, 3840, 4352, 2944, 7424}},
        {{-102, 54, 11, 19, -98, 26, 83, 57},
         {-204, 108, 22, 38, -196, 52, 166, 114},
         {-816, 432, 88, 152, -784, 208, 664, 456},
         {-3264, 1728, 352, 608, -3136, 832, 2656, 1824},
         {-6528, 3456, 704, 1216, -6272, 1664, 5312, 3648},
         {-13056, 6912, 1408, 2432, -12544, 3328, 10624, 7296}},
        {{-82, -117, 13, 89, -127, 102, -127, -50},
         {-164, -234, 26, 178, -254, 204, -254, -100},
         {-656, -936, 104, 712, -1016, 816, -1016, -400},
         {-2624, -3744, 416, 2848, -4064, 3264, -4064, -1600},
         {-5248, -7488, 832, 5696, -8128, 6528, -8128, -3200},
         {-10496, -14976, 1664, 11392, -16256, 13056, -16256, -6400}},
    };

    for (size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
        int8x8_t a = vld1_s8(test_vec[i].a);
        int16x8_t r1 = vshll_n_s8(a, 1);
        int16x8_t r3 = vshll_n_s8(a, 3);
        int16x8_t r5 = vshll_n_s8(a, 5);
        int16x8_t r6 = vshll_n_s8(a, 6);
        int16x8_t r7 = vshll_n_s8(a, 7);
        int16x8_t check1 = vld1q_s16(test_vec[i].r1);
        int16x8_t check3 = vld1q_s16(test_vec[i].r3);
        int16x8_t check5 = vld1q_s16(test_vec[i].r5);
        int16x8_t check6 = vld1q_s16(test_vec[i].r6);
        int16x8_t check7 = vld1q_s16(test_vec[i].r7);
        ASSERT_EQUAL(r1, check1);
        ASSERT_EQUAL(r3, check3);
        ASSERT_EQUAL(r5, check5);
        ASSERT_EQUAL(r6, check6);
        ASSERT_EQUAL(r7, check7);
    }
    return 0;
}
